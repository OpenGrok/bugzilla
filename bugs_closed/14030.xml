<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "http://defect.opensolaris.org/bz/bugzilla.dtd">

<bugzilla version="3.6.5"
          urlbase="http://defect.opensolaris.org/bz/"
          
          maintainer="website-admin@opensolaris.org"
>

    <bug>
          <bug_id>14030</bug_id>
          
          <creation_ts>2010-01-21 09:08:00 +0000</creation_ts>
          <short_desc>Many lines with same line number (regression)</short_desc>
          <delta_ts>2010-05-11 08:32:02 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Development</classification>
          <product>opengrok</product>
          <component>analyzer</component>
          <version>unspecified</version>
          <rep_platform>ANY/Generic</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>FIXED</resolution>
          
          
          
          
          
          <priority>P3</priority>
          <bug_severity>major</bug_severity>
          <target_milestone>0.9</target_milestone>
          
          <blocked>15932</blocked>
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Knut Anders Hatlen">knut.hatlen</reporter>
          <assigned_to name="Lubos Kosco">Lubos.Kosco</assigned_to>
          <cc>Lubos.Kosco</cc>
    
    <cc>opengrok-dev</cc>
          

      

      

      

          <long_desc isprivate="0">
            <commentid>63130</commentid>
              <attachid>3468</attachid>
            <who name="Knut Anders Hatlen">knut.hatlen</who>
            <bug_when>2010-01-21 09:08:48 +0000</bug_when>
            <thetext>Created attachment 3468
Derby&apos;s TransactionTable class

When indexing the attached file (the TransactionTable class from Apache Derby)
there are three lines with line number 215. Parts of what should have been at
line 214 have also been moved to one of the lines with number 215.

This was the first changeset that showed this behaviour:

changeset:   936:823baf58f250
user:        Lubos Kosco &lt;Lubos.Kosco@Sun.COM&gt;
date:        Tue Jan 19 10:06:50 2010 +0100
summary:     Bug #13949 -  Missing line numbers in xref for XML file</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>63132</commentid>
            <who name="Knut Anders Hatlen">knut.hatlen</who>
            <bug_when>2010-01-21 09:14:14 +0000</bug_when>
            <thetext>Same issue with lines 630/631, 686/687, 782/783 and 874/875. It looks like this happens with all lines that contain || (logical or).</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>63137</commentid>
            <who name="Knut Anders Hatlen">knut.hatlen</who>
            <bug_when>2010-01-21 09:23:09 +0000</bug_when>
            <thetext>The EOL patterns in the xreffers look like this:

EOL = [\r|\n|\r\n|\u2028|\u2029|\u000B|\u000C|\u0085]

The pipes should not be there, so they all need to be changed to this:

EOL = [\r\n\r\n\u2028\u2029\u000B\u000C\u0085]</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>63141</commentid>
            <who name="Knut Anders Hatlen">knut.hatlen</who>
            <bug_when>2010-01-21 09:28:23 +0000</bug_when>
            <thetext>The last comment is not correct. We should use (...) instead of [...] and keep the pipes. Otherwise, multi-char expressions (like \r\n) won&apos;t be recognized.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>63151</commentid>
            <who name="Lubos Kosco">Lubos.Kosco</who>
            <bug_when>2010-01-21 10:29:27 +0000</bug_when>
            <thetext>got rid of [ ] in EOL variable
changeset:   939:a274bdc59fc7

will work on tests for this</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>63153</commentid>
            <who name="Lubos Kosco">Lubos.Kosco</who>
            <bug_when>2010-01-21 10:40:06 +0000</bug_when>
            <thetext>a good test might be to generate xref and junit test them for repeating line #</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>72762</commentid>
            <who name="Lubos Kosco">Lubos.Kosco</who>
            <bug_when>2010-05-11 08:31:14 +0000</bug_when>
            <thetext>will file a new bug for the test</thetext>
          </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
              isurl="0"
          >
            <attachid>3468</attachid>
            <date>2010-01-21 09:08:00 +0000</date>
            <delta_ts>2010-01-21 09:08:48 +0000</delta_ts>
            <desc>Derby&apos;s TransactionTable class</desc>
            <filename>TransactionTable.java</filename>
            <type>text/x-java</type>
            <size>31434</size>
            <attacher>knut.hatlen</attacher>
            
              <data encoding="base64">LyoKCiAgIERlcmJ5IC0gQ2xhc3Mgb3JnLmFwYWNoZS5kZXJieS5pbXBsLnN0b3JlLnJhdy54YWN0
LlRyYW5zYWN0aW9uVGFibGUKCiAgIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91
bmRhdGlvbiAoQVNGKSB1bmRlciBvbmUgb3IgbW9yZQogICBjb250cmlidXRvciBsaWNlbnNlIGFn
cmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlIGRpc3RyaWJ1dGVkIHdpdGgKICAgdGhpcyB3
b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJz
aGlwLgogICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZSB0byB5b3UgdW5kZXIgdGhlIEFwYWNo
ZSBMaWNlbnNlLCBWZXJzaW9uIDIuMAogICAodGhlICJMaWNlbnNlIik7IHlvdSBtYXkgbm90IHVz
ZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aAogICB0aGUgTGljZW5zZS4gIFlv
dSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoKICAgICAgaHR0cDovL3d3dy5h
cGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgogICBVbmxlc3MgcmVxdWlyZWQgYnkgYXBw
bGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAgIGRpc3RyaWJ1
dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMs
CiAgIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIg
ZXhwcmVzcyBvciBpbXBsaWVkLgogICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBs
YW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAgIGxpbWl0YXRpb25zIHVuZGVyIHRo
ZSBMaWNlbnNlLgoKICovCgpwYWNrYWdlIG9yZy5hcGFjaGUuZGVyYnkuaW1wbC5zdG9yZS5yYXcu
eGFjdDsKCmltcG9ydCBvcmcuYXBhY2hlLmRlcmJ5LmlhcGkuc2VydmljZXMuY29udGV4dC5Db250
ZXh0TWFuYWdlcjsKCmltcG9ydCBvcmcuYXBhY2hlLmRlcmJ5LmlhcGkuc2VydmljZXMuc2FuaXR5
LlNhbml0eU1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLmRlcmJ5LmlhcGkuc2VydmljZXMuaW8u
Rm9ybWF0YWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUuZGVyYnkuaWFwaS5zZXJ2aWNlcy5pby5TdG9y
ZWRGb3JtYXRJZHM7CgppbXBvcnQgb3JnLmFwYWNoZS5kZXJieS5pYXBpLnN0b3JlLmFjY2Vzcy5U
cmFuc2FjdGlvbkluZm87CgppbXBvcnQgb3JnLmFwYWNoZS5kZXJieS5pYXBpLnN0b3JlLnJhdy5H
bG9iYWxUcmFuc2FjdGlvbklkOwoKaW1wb3J0IG9yZy5hcGFjaGUuZGVyYnkuaWFwaS5zdG9yZS5y
YXcubG9nLkxvZ0luc3RhbnQ7CgppbXBvcnQgb3JnLmFwYWNoZS5kZXJieS5pYXBpLnN0b3JlLnJh
dy54YWN0LlJhd1RyYW5zYWN0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5kZXJieS5pYXBpLnN0b3Jl
LnJhdy54YWN0LlRyYW5zYWN0aW9uSWQ7CgppbXBvcnQgb3JnLmFwYWNoZS5kZXJieS5pYXBpLnNl
cnZpY2VzLmlvLkNvbXByZXNzZWROdW1iZXI7CgppbXBvcnQgamF2YS51dGlsLkhhc2h0YWJsZTsK
aW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5NYXA7CgppbXBvcnQg
amF2YS5pby5PYmplY3RPdXRwdXQ7CmltcG9ydCBqYXZhLmlvLk9iamVjdElucHV0OwppbXBvcnQg
amF2YS5pby5JT0V4Y2VwdGlvbjsKCi8qKgoJVGhlIHRyYW5zYWN0aW9uIHRhYmxlIGlzIHVzZWQg
YnkgdGhlIHRyYW5zYWN0aW9uIGZhY3RvcnkgdG8ga2VlcCB0cmFjayBvZgoJYWxsIHRyYW5zYWN0
aW9ucyB0aGF0IGFyZSBpbiB0aGUgc3lzdGVtLgoKCTxCUj4gVGhlIHRyYW5zY3Rpb24gdGFibGUg
c2VydmVzIHRoZSBmb2xsb3dpbmcgcHVycG9zZXM6IDxPTD4gCgoJPExJPiBjaGVja3BvaW50IC0g
d2hlbiBhIGNoZWNrcG9pbnQgbG9nIHJlY29yZCBpcyB3cml0dGVuIG91dCwgaXQgd3JpdGVzCglv
dXQgYWxzbyBhbGwgdHJhbnNhY3Rpb25zIHRoYXQgaGF2ZSB1cGRhdGVkIHRoZSBkYXRhYmFzZS4g
IFJFU09MVkU6IHRoaXMgaXMKCWFjdHVhbGx5IG5vdCB1c2VkIHJpZ2h0IG5vdyAtIHJhdGhlciwg
dGhlIHRyYW5zYWN0aW9uIHRhYmxlIGlzCglyZWNvbnN0cnVjdGVkIGR1cmluZyB0aGUgcmVkbyBw
aGFzZSBieSB0cmF2ZXJzaW5nIGZyb20gdGhlIHVuZG8gTFdNLiAgSXQgaXMKCWEgZ29hbCB0byB1
c2UgdGhpcyB0cmFuc2FjdGlvbiB0YWJsZSAoYW5kIHRyYXZlcnNpbmcgZnJvbSB0aGUgcmVkb0xX
TSkKCWluc3RlYWQgb2YgcmVidWlsZGluZyBpdCB0byBzcGVlZCB1cCByZWNvdmVyeS4KCgk8TEk+
IFF1aWVzY2UgU3RhdGUgLSB3aGVuIGEgIHN5c3RlbSBlbnRlcnMgdGhlIHF1aWVzY2Ugc3RhdGUs
IGl0IG5lZWRzIHRvIGFjY291bnQKCWZvciBhbGwgdHJhbnNhY3Rpb25zIGluIHRoZSBzeXN0ZW0s
IGV2ZW4gdGhvc2Ugd2hpY2ggYXJlIGp1c3Qgc3RhcnRlZCBhbmQKCWFyZSBpbiB0aGVpciBJRExF
IHN0YXRlLgoKCTxMST4gVHJhbnNhY3Rpb25UYWJsZSBWVEkgLSB3ZSBuZWVkIHRvIGdldCBhIHNu
YXBzaG90IG9mIGFsbCB0cmFuc2FjdGlvbnMKCWluIHRoZSBzeXN0ZW0gZm9yIGRpYWdub3N0aWMg
cHVycG9zZXMuCgk8L09MPgoKCUluIG9yZGVyIHRvIHNwZWVkIHVwIHRoZSB0aW1lIGl0IHRha2Vz
IHRvIGxvb2sgdXAgYSB0cmFuc2FjdGlvbiBmcm9tIHRoZQoJdHJhbnNhY3Rpb24gdGFibGUsIGVh
Y2ggdHJhbnNhY3Rpb24gbXVzdCBoYXZlIGEgdW5pcXVlIHRyYW5zYWN0aW9uIElkLgoJVGhpcyBt
ZWFucyBuZXdseSBjb2luZWQgdHJhbnNhY3Rpb24gbXVzdCBhbHNvIGhhdmUgYSB0cmFuc2FjdGlv
biBJZC4KCgk8UD5EdXJpbmcgcmVjb3ZlcnksIHRoZXJlIGlzIG9ubHkgb25lIHJlYWwgeGFjdCBv
YmplY3QgZG9pbmcgYWxsIHRoZQoJcmVjb3Zlcnkgd29yaywgYnV0IHRoZXJlIGNvdWxkIGJlIG1h
bnkgb3V0c3RhbmRpbmcgdHJhbnNhY3Rpb25zIHRoYXQgYXJlCglnbGVhbWVkIGZyb20gdGhlIGxv
Zy4gIEVhY2ggb2YgdGhlc2UgInJlY292ZXJ5IHRyYW5zYWN0aW9ucyIgaGF2ZSBpdHMgb24KCWVu
dHJ5IGludG8gdGhlIHRyYW5zYWN0aW9uIHRhYmxlIGJ1dCB0aGV5IGFsbCBzaGFyZSB0aGUgc2Ft
ZSBYYWN0IG9iamVjdC4KCgk8UD5NdWx0aXRocmVhZGluZyBjb25zaWRlcmF0aW9uczo8QlI+CglU
cmFuc2FjdGlvblRhYmxlIG11c3QgYmUgTVQtc2FmZSBpdCBpcyBjYWxsZWQgdXBvbiBieSBtYW55
IHRocmVhZHMKCXNpbXVsdGFuZW91c2x5IChleGNlcHQgZHVyaW5nIHJlY292ZXJ5KQoKCTxQPjxC
PiBUaGlzIGNsYXNzIGRlcGVuZHMgb24gSGFzaHRhYmxlIHN5bmNocm9uaXphdGlvbiEhIDwvQj4K
CiovCgpwdWJsaWMgY2xhc3MgVHJhbnNhY3Rpb25UYWJsZSBpbXBsZW1lbnRzIEZvcm1hdGFibGUK
ewoJLyoKCSAqIEZpZWxkcwoJICovCgoJcHJpdmF0ZSBmaW5hbCBNYXAgdHJhbnM7CgoJcHJpdmF0
ZSBUcmFuc2FjdGlvbklkIGxhcmdlc3RVcGRhdGVYYWN0SWQ7CgoJLyoqCgkJTVQgLSBub3QgbmVl
ZGVkIGZvciBjb25zdHJ1Y3RvcgoJKi8KCXB1YmxpYyBUcmFuc2FjdGlvblRhYmxlKCkKCXsKCQl0
cmFucyA9IG5ldyBIYXNodGFibGUoMTcpOwoJfQoKCS8qKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCgkgKiBnZW5lcmljIG1ldGhvZHMg
Y2FsbGVkIGJ5IGFsbCBjbGllbnRzIG9mIHRyYW5zYWN0aW9uIHRhYmxlCgkgKiBNdXN0IGJlIE1U
IC1zYWZlCgkgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqLwoJcHJpdmF0ZSBUcmFuc2FjdGlvblRhYmxlRW50cnkgZmluZFRyYW5zYWN0
aW9uRW50cnkoVHJhbnNhY3Rpb25JZCBpZCkKCXsKCgkJaWYgKFNhbml0eU1hbmFnZXIuREVCVUcp
CgkJCVNhbml0eU1hbmFnZXIuQVNTRVJUKAogICAgICAgICAgICAgICAgaWQgIT0gbnVsbCwgImZp
bmRUcmFuc2FjaW9uRW50cnkgd2l0aCBudWxsIGlkIik7CgoJCS8vIEhhc2h0YWJsZSBpcyBzeW5j
aHJvbml6ZWQKCQlyZXR1cm4gKFRyYW5zYWN0aW9uVGFibGVFbnRyeSl0cmFucy5nZXQoaWQpOwoJ
fQoKICAgIC8qKgogICAgICogSW50ZXJmYWNlIGZvciB2aXNpdGluZyBlbnRyaWVzIGluIHRoZSB0
cmFuc2FjdGlvbiB0YWJsZS4KICAgICAqIEBzZWUgI3Zpc2l0RW50cmllcyhFbnRyeVZpc2l0b3Ip
CiAgICAgKi8KICAgIHN0YXRpYyBpbnRlcmZhY2UgRW50cnlWaXNpdG9yIHsKICAgICAgICAvKioK
ICAgICAgICAgKiBWaXNpdCBhbiBlbnRyeS4ge0BsaW5rICN2aXNpdEVudHJpZXMoRW50cnlWaXNp
dG9yKX0gd2lsbCBjYWxsIHRoaXMKICAgICAgICAgKiBtZXRob2Qgb25jZSBmb3IgZWFjaCBlbnRy
eSBpbiB0aGUgdHJhbnNhY3Rpb24gdGFibGUuCiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0g
ZW50cnkgdGhlIHtAY29kZSBUcmFuc2FjdGlvblRhYmxlRW50cnl9IGJlaW5nIHZpc2l0ZWQKICAg
ICAgICAgKi8KICAgICAgICB2b2lkIHZpc2l0KFRyYW5zYWN0aW9uVGFibGVFbnRyeSBlbnRyeSk7
CiAgICB9CgogICAgLyoqCiAgICAgKiA8cD4KICAgICAqIFZpc2l0IGFsbCB0aGUgZW50cmllcyBp
biB0aGUgdHJhbnNhY3Rpb24gdGFibGUuCiAgICAgKiA8L3A+CiAgICAgKgogICAgICogPHA+CiAg
ICAgKiBNVCAtIE1UIHNhZmUKICAgICAqIDwvcD4KICAgICAqCiAgICAgKiBAcGFyYW0gdmlzaXRv
ciB0aGUgdmlzaXRvciB0byBhcHBseSBvbiBlYWNoIHRyYW5zYWN0aW9uIHRhYmxlIGVudHJ5CiAg
ICAgKi8KICAgIHZvaWQgdmlzaXRFbnRyaWVzKEVudHJ5VmlzaXRvciB2aXNpdG9yKSB7CiAgICAg
ICAgc3luY2hyb25pemVkICh0cmFucykgewogICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ID0g
dHJhbnMudmFsdWVzKCkuaXRlcmF0b3IoKTsgaXQuaGFzTmV4dCgpOyApIHsKICAgICAgICAgICAg
ICAgIHZpc2l0b3IudmlzaXQoKFRyYW5zYWN0aW9uVGFibGVFbnRyeSkgaXQubmV4dCgpKTsKICAg
ICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCgoJdm9pZCBhZGQoWGFjdCB4YWN0LCBib29sZWFu
IGV4Y2x1ZGUpCgl7CgkJVHJhbnNhY3Rpb25JZCBpZCA9IHhhY3QuZ2V0SWQoKTsKCiAgICAgICAg
VHJhbnNhY3Rpb25UYWJsZUVudHJ5IG5ld0VudHJ5ID0gbmV3IFRyYW5zYWN0aW9uVGFibGVFbnRy
eSgKICAgICAgICAgICAgICAgIHhhY3QsIGlkLCAwLCBleGNsdWRlID8gVHJhbnNhY3Rpb25UYWJs
ZUVudHJ5LkVYQ0xVREUgOiAwKTsKCgkJc3luY2hyb25pemVkKHRoaXMpCgkJewogICAgICAgICAg
ICBPYmplY3Qgb2xkRW50cnkgPSB0cmFucy5wdXQoaWQsIG5ld0VudHJ5KTsKCiAgICAgICAgICAg
IGlmIChTYW5pdHlNYW5hZ2VyLkRFQlVHKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBT
YW5pdHlNYW5hZ2VyLkFTU0VSVCgKICAgICAgICAgICAgICAgICAgICAgICAgb2xkRW50cnkgPT0g
bnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgIlRyeWluZyB0byBhZGQgYSB0cmFuc2FjdGlv
biB0aGF0J3MgYWxyZWFkeSAiICsKICAgICAgICAgICAgICAgICAgICAgICAgImluIHRoZSB0cmFu
c2FjdGlvbiB0YWJsZSIpOwoKICAgICAgICAgICAgICAgIGlmIChTYW5pdHlNYW5hZ2VyLkRFQlVH
X09OKCJUcmFuVHJhY2UiKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBT
YW5pdHlNYW5hZ2VyLkRFQlVHKAogICAgICAgICAgICAgICAgICAgICAgICAiVHJhblRyYWNlIiwg
ImFkZGluZyB0cmFuc2FjdGlvbiAiICsgaWQpOwogICAgICAgICAgICAgICAgICAgIFNhbml0eU1h
bmFnZXIuc2hvd1RyYWNlKG5ldyBUaHJvd2FibGUoIlRyYW5UcmFjZSIpKTsKICAgICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgfQoJCX0KCgkJaWYgKFNhbml0eU1hbmFnZXIuREVCVUcpIHsKCgkJ
CWlmIChTYW5pdHlNYW5hZ2VyLkRFQlVHX09OKCJtZW1vcnlMZWFrVHJhY2UiKSkgewoKCQkJCWlm
ICh0cmFucy5zaXplKCkgPiA1MCkKCQkJCQlTeXN0ZW0ub3V0LnByaW50bG4oIm1lbW9yeUxlYWtU
cmFjZTpUcmFuc2FjdGlvblRhYmxlICIgKyB0cmFucy5zaXplKCkpOwoJCQl9CgkJfQoJfQoKCS8q
KgoJCXJlbW92ZSB0aGUgdHJhbnNhY3Rpb24gSWQgYW4gcmV0dXJuIGZhbHNlIGlmZiB0aGUgdHJh
bnNhY3Rpb24gaXMgZm91bmQKCQlpbiB0aGUgdGFibGUgYW5kIGl0IGRvZXNuJ3QgbmVlZCBleGNs
dXNpb24gZHVyaW5nIHF1aWVzY2Ugc3RhdGUKCSAqLwoJYm9vbGVhbiByZW1vdmUoVHJhbnNhY3Rp
b25JZCBpZCkKCXsKCQlpZiAoU2FuaXR5TWFuYWdlci5ERUJVRykKCQkJU2FuaXR5TWFuYWdlci5B
U1NFUlQoCiAgICAgICAgICAgICAgICBpZCAhPSBudWxsLCAKICAgICAgICAgICAgICAgICJjYW5u
b3QgcmVtb3ZlIHRyYW5zYWN0aW9uIGZyb20gdGFibGUgd2l0aCBudWxsIGlkIik7CgoJCWlmIChT
YW5pdHlNYW5hZ2VyLkRFQlVHKQogICAgICAgIHsKICAgICAgICAgICAgaWYgKFNhbml0eU1hbmFn
ZXIuREVCVUdfT04oIlRyYW5UcmFjZSIpKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBT
YW5pdHlNYW5hZ2VyLkRFQlVHKAogICAgICAgICAgICAgICAgICAgICJUcmFuVHJhY2UiLCAicmVt
b3ZpbmcgdHJhbnNhY3Rpb24gIiArIGlkKTsKICAgICAgICAgICAgICAgIFNhbml0eU1hbmFnZXIu
c2hvd1RyYWNlKG5ldyBUaHJvd2FibGUoIlRyYW5UcmFjZSIpKTsKICAgICAgICAgICAgfQogICAg
ICAgIH0KCgkJLy8gSGFzaHRhYmxlIGlzIHN5bmNocm9uaXplZAoJCSBUcmFuc2FjdGlvblRhYmxl
RW50cnkgZW50ID0gKFRyYW5zYWN0aW9uVGFibGVFbnRyeSl0cmFucy5yZW1vdmUoaWQpOwoJCSBy
ZXR1cm4gKGVudCA9PSBudWxsIHx8IGVudC5uZWVkRXhjbHVzaW9uKCkpOwoJfQoKCgkvKioKCQlD
aGFuZ2UgYSB0cmFuc2FjdGlvbiB0byB1cGRhdGUgb3IgYWRkIGFuIHVwZGF0ZSB0cmFuc2FjdGlv
biB0byB0aGlzIHRhYmxlLgoKCQlAcGFyYW0gdGlkIHRoZSB0cmFuc2FjdGlvbiBpZAoJCUBwYXJh
bSB0cmFuIHRoZSB0cmFuc2FjdGlvbiB0byBiZSBhZGRlZAoJCUBwYXJhbSB0cmFuc2FjdGlvblN0
YXR1cyB0aGUgdHJhbnNhY3Rpb24gc3RhdHVzIHRoYXQgaXMgc3RvcmVkIGluIHRoZQoJCQkJQmVn
aW5YYWN0IGxvZyByZWNvcmQKCSAqLwoJcHVibGljIHZvaWQgYWRkVXBkYXRlVHJhbnNhY3Rpb24o
VHJhbnNhY3Rpb25JZCB0aWQsIFJhd1RyYW5zYWN0aW9uIHRyYW4sCgkJCQkJCQkJCSBpbnQgdHJh
bnNhY3Rpb25TdGF0dXMpCgl7CgoJCS8vIHdlIG5lZWQgdG8gc3luY2hyb25pemUgb24gdGhlIHRy
YW5zYWN0aW9uIHRhYmxlIGJlY2F1c2Ugd2UgaGF2ZSB0bwoJCS8vIHByZXZlbnQgdGhpcyBzdGF0
ZSBjaGFuZ2UgZnJvbSBoYXBwZW5pbmcgd2hlbiB0aGUgdHJhbnNhY3Rpb24gdGFibGUKCQkvLyBp
dHNlbGYgaXMgd3JpdHRlbiBvdXQgdG8gdGhlIGNoZWNrcG9pbnQuICBUaGlzIGlzIHRoZSBvbmx5
CgkJLy8gcHJvdGVjdGlvbiB0aGUgVHJhbnNhY3Rpb25UYWJsZUVudHJ5IGhhcyB0byBwcmV2ZW50
IGZpZWxkcyBpbiBteXhhY3QKCQkvLyBmcm9tIGNoYW5naW5nIHVuZGVybmVhdGggaXQgd2hpbGUg
aXQgaXMgYmVpbmcgd3JpdHRlbiBvdXQuCgkJc3luY2hyb25pemVkKHRoaXMpCgkJewoJCQlUcmFu
c2FjdGlvblRhYmxlRW50cnkgZW50ID0gZmluZFRyYW5zYWN0aW9uRW50cnkodGlkKTsKCgkJCWlm
IChlbnQgIT0gbnVsbCkKCQkJewoJCQkJLy8gdGhpcyBoYXBwZW5zIGR1cmluZyBydW4gdGltZSwg
d2hlbiBhIHRyYW5zYWN0aW9uIHRoYXQgaXMKCQkJCS8vIGFscmVhZHkgc3RhcnRlZCBjaGFuZ2Vk
IHN0YXR1cyB0byBhbiB1cGRhdGUgdHJhbnNhY3Rpb24KCgkJCQllbnQudXBkYXRlVHJhbnNhY3Rp
b25TdGF0dXMoKFhhY3QpdHJhbiwgdHJhbnNhY3Rpb25TdGF0dXMsCgkJCQkJCQkJCQkJVHJhbnNh
Y3Rpb25UYWJsZUVudHJ5LlVQREFURSkgOwoJCQl9CgkJCWVsc2UKCQkJewoJCQkJLy8gdGhpcyBo
YXBwZW5zIGR1cmluZyByZWNvdmVyeSwgdGhhdCdzIHdoeSB3ZSBoYXZlbid0IHNlZW4KCQkJCS8v
IHRoaXMgdHJhbnNhY3Rpb24gYmVmb3JlIC0gaXQgaXMgYWRkZWQgaW4gdGhlIGRvTWUgb2YgdGhl
IAoJCQkJLy8gQmVnaW5YYWN0IGxvZyByZWNvcmQuCgkJCQkvLwoJCQkJLy8gTm8gbWF0dGVyIHdo
YXQgdGhpcyB0cmFuc2FjdGlvbiBpcywgaXQgd29uJ3QgbmVlZCB0byBiZSBydW4KCQkJCS8vIGlu
IHF1aWVzY2Ugc3RhdGUgYmVjYXVzZSB3ZSBhcmUgaW4gcmVjb3ZlcnkuCgkJCQllbnQgPSBuZXcg
VHJhbnNhY3Rpb25UYWJsZUVudHJ5KChYYWN0KXRyYW4sIHRpZCwgdHJhbnNhY3Rpb25TdGF0dXMs
IAoJCQkJCQkJCQkJCQlUcmFuc2FjdGlvblRhYmxlRW50cnkuVVBEQVRFIHwgCgkJCQkJCQkJCQkJ
CVRyYW5zYWN0aW9uVGFibGVFbnRyeS5FWENMVURFIHwKCQkJCQkJCQkJCQkJVHJhbnNhY3Rpb25U
YWJsZUVudHJ5LlJFQ09WRVJZKTsKCQkJCXRyYW5zLnB1dCh0aWQsIGVudCk7CgoJCQl9CgoJCQlp
ZiAoWGFjdElkLmNvbXBhcmUoZW50LmdldFhpZCgpLCBsYXJnZXN0VXBkYXRlWGFjdElkKSA+IDAp
CgkJCQlsYXJnZXN0VXBkYXRlWGFjdElkID0gZW50LmdldFhpZCgpOwoJCX0KCX0KCgkvKioKCSAg
ICBDaGFuZ2UgdXBkYXRlIHRyYW5zYWN0aW9uIHRvIG5vbi11cGRhdGUKCgkJPFA+TVQgLSBNVCBz
YWZlLCBzaW5jZSB2ZWN0b3IgaXMgTVQtc2FmZS4KCgkJQHBhcmFtIGlkIHRoZSB0cmFuc2FjdGlv
biBJZAoJICAqLwoJdm9pZCByZW1vdmVVcGRhdGVUcmFuc2FjdGlvbihUcmFuc2FjdGlvbklkIGlk
KQoJewoJCS8vIHdlIG5lZWQgdG8gc3luY2hyb25pemUgb24gdGhlIHRyYW5zYWN0aW9uIHRhYmxl
IGJlY2F1c2Ugd2UgaGF2ZSB0bwoJCS8vIHByZXZlbnQgdGhpcyBzdGF0ZSBjaGFuZ2UgZnJvbSBo
YXBwZW5pbmcgd2hlbiB0aGUgdHJhbnNhY3Rpb24gdGFibGUKCQkvLyBpdHNlbGYgaXMgd3JpdHRl
biBvdXQgdG8gdGhlIGNoZWNrcG9pbnQuICBUaGlzIGlzIHRoZSBvbmx5CgkJLy8gcHJvdGVjdGlv
biB0aGUgVHJhbnNhY3Rpb25UYWJsZUVudHJ5IGhhcyB0byBwcmV2ZW50IGZpZWxkcyBpbiBteXhh
Y3QKCQkvLyBmcm9tIGNoYW5naW5nIHVuZGVybmVhdGggaXQgd2hpbGUgaXQgaXMgYmVpbmcgd3Jp
dHRlbiBvdXQuCgoJCXN5bmNocm9uaXplZCAodGhpcykKCQl7CgkJCVRyYW5zYWN0aW9uVGFibGVF
bnRyeSBlbnQgPSBmaW5kVHJhbnNhY3Rpb25FbnRyeShpZCk7CgoJCQlpZiAoU2FuaXR5TWFuYWdl
ci5ERUJVRykKCQkJewoJCQkJU2FuaXR5TWFuYWdlci5BU1NFUlQoZW50ICE9IG51bGwsIAoJCQkJ
ICJyZW1vdmluZyB1cGRhdGUgdHJhbnNhY3Rpb24gdGhhdCBpcyBub3QgdGhlcmUiKTsKCQkJfQoK
CQkJZW50LnJlbW92ZVVwZGF0ZVRyYW5zYWN0aW9uKCk7CgoJCQkvLyBJZiB3ZSBhcmUgY29tbWl0
dGluZyBhIHJlY292ZXJ5IHRyYW5zYWN0aW9uLCByZW1vdmUgaXQgZnJvbSB0aGUKCQkJLy8gdHJh
bnNhY3Rpb24gdGFibGUuICBUaGUgeGFjdCBvYmplY3Qgd2hpY2ggaXMgZG9pbmcgdGhlIHdvcmsg
aXMKCQkJLy8gbm90IGdvaW5nIHRvIGJlIGNsb3NlZCBldmVuIHRob3VnaCB0aGUgdHJhbnNhY3Rp
b24gaXMgZG9uZS4KCQkJaWYgKGVudC5pc1JlY292ZXJ5KCkpCgkJCQlyZW1vdmUoaWQpOwoJCX0K
CgkJcmV0dXJuOwoJfQoKICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogICAgICogVHJhbnNhY3Rpb24g
dGFibGUgbWV0aG9kcyB1c2VkIGJ5IFhBLgogICAgICoqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAgICAgKi8K
CgkvKioKCSAgICBDaGFuZ2UgdHJhbnNhY3Rpb24gdG8gcHJlcGFyZWQuCgoJCTxQPk1UIC0gdW5z
YWZlLCBjYWxsZXIgaXMgcmVjb3ZlcnksIHdoaWNoIGlzIHNpbmdsZSB0aHJlYWRlZC4KCgkJQHBh
cmFtIGlkIHRoZSB0cmFuc2FjdGlvbiBJZAoJICAqLwoJdm9pZCBwcmVwYXJlVHJhbnNhY3Rpb24o
VHJhbnNhY3Rpb25JZCBpZCkKCXsKCQkvLyB3ZSBuZWVkIHRvIHN5bmNocm9uaXplIG9uIHRoZSB0
cmFuc2FjdGlvbiB0YWJsZSBiZWNhdXNlIHdlIGhhdmUgdG8KCQkvLyBwcmV2ZW50IHRoaXMgc3Rh
dGUgY2hhbmdlIGZyb20gaGFwcGVuaW5nIHdoZW4gdGhlIHRyYW5zYWN0aW9uIHRhYmxlCgkJLy8g
aXRzZWxmIGlzIHdyaXR0ZW4gb3V0IHRvIHRoZSBjaGVja3BvaW50LiAgVGhpcyBpcyB0aGUgb25s
eQoJCS8vIHByb3RlY3Rpb24gdGhlIFRyYW5zYWN0aW9uVGFibGVFbnRyeSBoYXMgdG8gcHJldmVu
dCBmaWVsZHMgaW4gbXl4YWN0CgkJLy8gZnJvbSBjaGFuZ2luZyB1bmRlcm5lYXRoIGl0IHdoaWxl
IGl0IGlzIGJlaW5nIHdyaXR0ZW4gb3V0LgoKICAgICAgICBUcmFuc2FjdGlvblRhYmxlRW50cnkg
ZW50ID0gZmluZFRyYW5zYWN0aW9uRW50cnkoaWQpOwoKICAgICAgICBpZiAoU2FuaXR5TWFuYWdl
ci5ERUJVRykKICAgICAgICB7CiAgICAgICAgICAgIFNhbml0eU1hbmFnZXIuQVNTRVJUKAogICAg
ICAgICAgICAgICAgZW50ICE9IG51bGwsICJwcmVwYXJpbmcgdHJhbnNhY3Rpb24gdGhhdCBpcyBu
b3QgdGhlcmUiKTsKICAgICAgICB9CgogICAgICAgIGVudC5wcmVwYXJlVHJhbnNhY3Rpb24oKTsK
CgkJcmV0dXJuOwoJfQoKICAgIC8qKgogICAgICogRmluZCBhIHRyYW5zYWN0aW9uIGluIHRoZSB0
YWJsZSBieSBHbG9iYWwgdHJhbnNhY3Rpb24gaWQuCiAgICAgKiA8cD4KICAgICAqIFRoaXMgcm91
dGluZSB1c2UgdG8gYmUgb25seSBjYWxsZWQgZHVyaW5nIG9mZmxpbmUgcmVjb3Zlcnkgc28gcGVy
Zm9ybWFuY2UKICAgICAqIHdhcyBub3QgY3JpdGljYWwuICBTaW5jZSB0aGF0IHRpbWUgbW9yZSBj
YWxscyBoYXZlIGJlZW4gbWFkZSwgaW5jbHVkaW5nCiAgICAgKiBvbmUgaW4gc3RhcnRHbG9iYWxU
cmFuc2FjdGlvbigpIHNvIGEgbGluZWFyIHNlYXJjaCBtYXkgbm8gbG9uZ2VyCiAgICAgKiBiZSBh
cHByb3ByaWF0ZS4gIFNlZSBERVJCWS04MjguCiAgICAgKgoJICogQHJldHVybiBUaGUgQ29udGV4
dE1hbmFnZXIgb2YgdGhlIHRyYW5zYWN0aW9uIGJlaW5nIHNlYXJjaGVkIGZvci4KICAgICAqCiAg
ICAgKiBAcGFyYW0gZ2xvYmFsX2lkIFRoZSBnbG9iYWwgdHJhbnNhY3Rpb24gd2UgYXJlIHNlYXJj
aGluZyBmb3IuCiAgICAgKiovCglwdWJsaWMgQ29udGV4dE1hbmFnZXIgZmluZFRyYW5zYWN0aW9u
Q29udGV4dEJ5R2xvYmFsSWQoCiAgICBHbG9iYWxYYWN0SWQgZ2xvYmFsX2lkKQoJewogICAgICAg
IENvbnRleHRNYW5hZ2VyIGNtICAgICAgICAgICAgICA9IG51bGw7CgogICAgICAgIC8vIE5lZWQg
dG8gaG9sZCBzeW5jIHdoaWxlIGxpbmVhciBzZWFyY2hpbmcgdGhlIGhhc2ggdGFibGUuCiAgICAg
ICAgc3luY2hyb25pemVkICh0cmFucykKICAgICAgICB7CiAgICAgICAgICAgIGZvciAoSXRlcmF0
b3IgaXQgPSB0cmFucy52YWx1ZXMoKS5pdGVyYXRvcigpOyBpdC5oYXNOZXh0KCk7ICkKICAgICAg
ICAgICAgewogICAgICAgICAgICAgICAgVHJhbnNhY3Rpb25UYWJsZUVudHJ5IGVudHJ5ID0gKFRy
YW5zYWN0aW9uVGFibGVFbnRyeSkgaXQubmV4dCgpOwoKICAgICAgICAgICAgICAgIGlmIChlbnRy
eSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIEdsb2JhbFRy
YW5zYWN0aW9uSWQgZW50cnlfZ2lkID0gZW50cnkuZ2V0R2lkKCk7CgogICAgICAgICAgICAgICAg
ICAgIGlmIChlbnRyeV9naWQgIT0gbnVsbCAmJiBlbnRyeV9naWQuZXF1YWxzKGdsb2JhbF9pZCkp
CiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBjbSA9IGVudHJ5
LmdldFhhY3QoKS5nZXRDb250ZXh0TWFuYWdlcigpOwogICAgICAgICAgICAgICAgICAgICAgICBi
cmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg
IH0KICAgICAgICB9CiAgICAgICAgICAgICAgCgkJcmV0dXJuKGNtKTsKCX0KCgoJLyoqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCgkgKiBj
YWxsZWQgd2hlbiBzeXN0ZW0gaXMgYmVpbmcgcXVpZXNjZWQsIG11c3QgYmUgTVQgLSBzYWZlCgkg
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KiovCgkvKioKCQlSZXR1cm4gdHJ1ZSBpZiB0aGVyZSBpcyBubyB0cmFuc2FjdGlvbiBhY3RpdmVs
eSB1cGRhdGluZyB0aGUgZGF0YWJhc2UuCgkJTmV3IHRyYW5zYWN0aW9uIG1heSBiZSBzdGFydGVk
IG9yIG9sZCB0cmFuc2FjdGlvbiBjb21taXR0ZWQKCQlyaWdodCBhZnRlcndhcmQsIHRoZSBjYWxs
ZXIgb2YgdGhpcyByb3V0aW5lIG11c3QgaGF2ZSBvdGhlciB3YXlzIHRvCgkJc3RvcCB0cmFuc2Fj
dGlvbnMgZnJvbSBzdGFydGluZyBvciBlbmRpbmcuCgoJCTxQPk1UIC0gc2FmZQoJKi8KCWJvb2xl
YW4gaGFzQWN0aXZlVXBkYXRlVHJhbnNhY3Rpb24oKQoJewoJCXN5bmNocm9uaXplZCAodGhpcykK
CQl7CgkJCWZvciAoSXRlcmF0b3IgaXQgPSB0cmFucy52YWx1ZXMoKS5pdGVyYXRvcigpOyBpdC5o
YXNOZXh0KCk7ICkKCQkJewoJCQkJVHJhbnNhY3Rpb25UYWJsZUVudHJ5IGVudCA9IChUcmFuc2Fj
dGlvblRhYmxlRW50cnkpIGl0Lm5leHQoKTsKCQkJCWlmIChlbnQgIT0gbnVsbCAmJiBlbnQuaXNV
cGRhdGUoKSkKCQkJCQlyZXR1cm4gdHJ1ZTsKCQkJfQoJCX0KCQlyZXR1cm4gZmFsc2U7Cgl9CgoK
CgkvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqCgkgKiBtZXRob2RzIGNhbGxlZCBvbmx5IGJ5IGNoZWNrcG9pbnQKCSAqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCS8qCgkg
KiBGb3JtYXRhYmxlIG1ldGhvZHMKCSAqLwoKCS8qKgoJCVJldHVybiBteSBmb3JtYXQgaWRlbnRp
Zmllci4KCSovCglwdWJsaWMgaW50IGdldFR5cGVGb3JtYXRJZCgpIHsKCQlyZXR1cm4gU3RvcmVk
Rm9ybWF0SWRzLlJBV19TVE9SRV9UUkFOU0FDVElPTl9UQUJMRTsKCX0KCgkvKioKCSAgQGV4Y2Vw
dGlvbiBJT0V4Y2VwdGlvbiBwcm9ibGVtIHJlYWRpbmcgdGhlIHRyYW5zYWN0aW9uIHRhYmxlCgkq
LwoJcHVibGljIHZvaWQgd3JpdGVFeHRlcm5hbChPYmplY3RPdXRwdXQgb3V0KSB0aHJvd3MgSU9F
eGNlcHRpb24gCgl7CgkJLy9kb24ndCBsZXQgdGhlIHRyYW5zYWN0aW9ucyBzdGF0dXMgY2hhbmdl
IHdoaWxlIHdyaXRpbmcgb3V0KGJlZXRsZTo1NTMzKQoJCS8vTm90ZTogc3luY2luZyBib3RoIG9u
IHRyYW5zIGFuZCB0aGlzIHZhcmlhYmxlIGNvdWxkIGJlIGF2b2lkZWQgaWYKCQkvL2FsbCB0aGUg
cm91dGluZXMgaW4gdGhpcyBjbGFzcyBhcmUgc3ljbmVkIG9uICJ0aGlzIiBhbmQgZG9lcyBub3QK
CQkvL2RlcGVuZCBvbiBoYXNoIHRhYmxlIHN5bmNocm9uaXphdGlvbi4gQnV0IHRoYXQgd2lsbCBi
ZSBvdmVya2lsbCAKCQkvL2JlY2F1c2UgdGhpcyByb3V0aW5lIGdldHMgY2FsbGVkIG9ubHkgb24g
Y2hlY2twb2ludHMgYW5kIG90aGVycwoJCS8vYXJlIHVzZWQgbW9yZSBvZnRlbi4KCgkJc3luY2hy
b25pemVkKHRoaXMpCgkJewkKCQkJLy8gZG9uJ3QgdG91Y2ggdGhlIHRyYW5zYWN0aW9uIHRhYmxl
IHdoZW4gSSBhbSBiZWluZyB3cml0dGVuIG91dAoJCQlzeW5jaHJvbml6ZWQodHJhbnMpCgkJCXsK
CQkJCWludCBjb3VudCA9IDA7CgoJCQkJLy8gZmlyc3QgY291bnQgdXAgdGhlIG51bWJlciBvZiBh
Y3RpdmUgdXBkYXRlIHRyYW5zYWN0aW9ucyAKCQkJCWZvciAoSXRlcmF0b3IgaXQgPSB0cmFucy52
YWx1ZXMoKS5pdGVyYXRvcigpOyBpdC5oYXNOZXh0KCk7ICkKCQkJCXsKCQkJCQlUcmFuc2FjdGlv
blRhYmxlRW50cnkgZW50ID0KCQkJCQkJCShUcmFuc2FjdGlvblRhYmxlRW50cnkpIGl0Lm5leHQo
KTsKCQkJCQlpZiAoZW50ICE9IG51bGwgJiYgZW50LmlzVXBkYXRlKCkpCgkJCQkJCWNvdW50Kys7
CgkJCQl9CgoJCQkJQ29tcHJlc3NlZE51bWJlci53cml0ZUludChvdXQsIGNvdW50KTsKCgkJCQkv
LyBub3cgd3JpdGUgdGhlbSBvdXQKCQkJCWlmIChjb3VudCA+IDApCgkJCQl7CgkJCQkJZm9yIChJ
dGVyYXRvciBpdCA9IHRyYW5zLnZhbHVlcygpLml0ZXJhdG9yKCk7IGl0Lmhhc05leHQoKTspCgkJ
CQkJewoJCQkJCQlUcmFuc2FjdGlvblRhYmxlRW50cnkgZW50ID0KCQkJCQkJCQkoVHJhbnNhY3Rp
b25UYWJsZUVudHJ5KSBpdC5uZXh0KCk7CgkJCQkJCWlmIChlbnQgIT0gbnVsbCAmJiBlbnQuaXNV
cGRhdGUoKSkKCQkJCQkJewoJCQkJCQkJLy8gb25seSB3cml0ZSBvdXQgdXBkYXRlIHRyYW5zYWN0
aW9ucwoJCQkJCQkJb3V0LndyaXRlT2JqZWN0KGVudCk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJ
CX0KCQl9Cgl9CgoJLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKgoJICogbWV0aG9kcyBjYWxsZWQgb25seSBieSByZWNvdmVyeQoJICoq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
Ki8KCgoJLyoqCgkgIEBleGNlcHRpb24gSU9FeGNlcHRpb24gcHJvYmxlbSByZWFkaW5nIHRoZSB0
cmFuc2FjdGlvbiB0YWJsZQoJICBAZXhjZXB0aW9uIENsYXNzTm90Rm91bmRFeGNlcHRpb24gcHJv
YmxlbSByZWFkaW5nIHRoZSB0cmFuc2FjdGlvbiB0YWJsZQoJICovCglwdWJsaWMgdm9pZCByZWFk
RXh0ZXJuYWwoT2JqZWN0SW5wdXQgaW4pIAoJCSB0aHJvd3MgSU9FeGNlcHRpb24sIENsYXNzTm90
Rm91bmRFeGNlcHRpb24KCXsKCQkvLyBSRVNPTFZFOiB0aGlzIGlzIG9ubHkgcmVhZCBpbiBjaGVj
a3BvaW50IHJlY29yZCwgYnV0IHdlIGhhdmUgbm90CgkJLy8gZmluaXNoIHRoZSB3b3JrIG9uIHVz
aW5nIHRoaXMgdHJhbnNhY3Rpb24gdGFibGUgdG8gY3V0IGRvd24gb24gcmVkbwoJCS8vIHNvIHRo
aXMgdHJhbnNhY3Rpb24gdGFibGUgaXMgZWZmZWN0aXZlbHkgYW5kIGZ1dGlsZWx5IHRocm93biBh
d2F5IQoKCQlpbnQgY291bnQgPSBDb21wcmVzc2VkTnVtYmVyLnJlYWRJbnQoaW4pOwoJCWlmIChj
b3VudCA9PSAwKQoJCQlyZXR1cm47CgoJCWZvciAoaW50IGkgPSAwOyBpIDwgY291bnQ7IGkrKykK
CQl7CgkJCVRyYW5zYWN0aW9uVGFibGVFbnRyeSBlbnQgPSAKCQkJCShUcmFuc2FjdGlvblRhYmxl
RW50cnkpaW4ucmVhZE9iamVjdCgpOwoKCQkJaWYgKFNhbml0eU1hbmFnZXIuREVCVUcpCgkJCQlT
YW5pdHlNYW5hZ2VyLkFTU0VSVCgKICAgICAgICAgICAgICAgICAgICBlbnQuZ2V0WGlkKCkgIT0g
bnVsbCwKICAgICAgICAgICAgICAgICAgICAicmVhZCBpbiB0cmFuc2FjdGlvbiB0YWJsZSBlbnRy
eSB3aXRoIG51bGwgaWQiKTsKCgkJCXRyYW5zLnB1dChlbnQuZ2V0WGlkKCksIGVudCk7CgoJCQlp
ZiAoZW50LmlzVXBkYXRlKCkgJiYgCiAgICAgICAgICAgICAgICBYYWN0SWQuY29tcGFyZShlbnQu
Z2V0WGlkKCksIGxhcmdlc3RVcGRhdGVYYWN0SWQpID4gMCkKICAgICAgICAgICAgewoJCQkJbGFy
Z2VzdFVwZGF0ZVhhY3RJZCA9IGVudC5nZXRYaWQoKTsKICAgICAgICAgICAgfQoJCX0KCgoJfQoK
CS8qKgoJCVJldHVybiB0aGUgbGFyZ2VzdCB1cGRhdGUgdHJhbnNhY3Rpb25JZCBJIGhhdmUgc2Vl
biBzbyBmYXIuCgoJCTxQPk1UIC0gdW5zYWZlLCBjYWxsZXIgaXMgcmVjb3ZlcnksIHdoaWNoIGlz
IHNpbmdsZSB0aHJlYWRlZC4KCSovCglwdWJsaWMgVHJhbnNhY3Rpb25JZCBsYXJnZXN0VXBkYXRl
WGFjdElkKCkKCXsKCQlyZXR1cm4gbGFyZ2VzdFVwZGF0ZVhhY3RJZDsKCX0KCgoJLyoqCgkJSXMg
dGhlcmUgYW4gYWN0aXZlIGludGVybmFsIHRyYW5zYWN0aW9uIGluIHRoZSB0cmFuc2FjdGlvbiB0
YWJsZS4KCgkJPFA+TVQgLSB1bnNhZmUsIGNhbGxlciBpcyByZWNvdmVyeSwgd2hpY2ggaXMgc2lu
Z2xlIHRocmVhZGVkLgoJKi8KCXB1YmxpYyBib29sZWFuIGhhc1JvbGxiYWNrRmlyc3RUcmFuc2Fj
dGlvbigpCgl7CgkJZm9yIChJdGVyYXRvciBpdCA9IHRyYW5zLnZhbHVlcygpLml0ZXJhdG9yKCk7
IGl0Lmhhc05leHQoKTsgKQoJCXsKCQkJVHJhbnNhY3Rpb25UYWJsZUVudHJ5IGVudCA9IChUcmFu
c2FjdGlvblRhYmxlRW50cnkpIGl0Lm5leHQoKTsKCgkJCWlmIChlbnQgIT0gbnVsbCAmJiBlbnQu
aXNSZWNvdmVyeSgpICYmIAoJCQkJKGVudC5nZXRUcmFuc2FjdGlvblN0YXR1cygpICYgCiAgICAg
ICAgICAgICAgICAgICAgIFhhY3QuUkVDT1ZFUllfUk9MTEJBQ0tfRklSU1QpICE9IDApCiAgICAg
ICAgICAgIHsKCQkJCXJldHVybiB0cnVlOwogICAgICAgICAgICB9CgkJfQoJCXJldHVybiBmYWxz
ZTsKCX0KCgkvKioKICAgICAgIElzIHRoZXJlIGEgcHJlcGFyZWQgdHJhbnNhY3Rpb24gdGhhdCBh
cmUgcmVjb3ZlcmVkIAogICAgICAgZHVycmluZyB0aGUgcmVjb3ZlcnkgaW4gdGhlIHRyYW5zYWN0
aW9uIHRhYmxlLgoKICAgICAgIDxQPk1UIC0gdW5zYWZlLCBjYWxsZXIgaXMgcmVjb3ZlcnksIHdo
aWNoIGlzIHNpbmdsZSB0aHJlYWRlZC4KICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBoYXNQcmVw
YXJlZFJlY292ZXJlZFhhY3QoKQogICAgewogICAgICAgIHJldHVybiBoYXNQcmVwYXJlZFhhY3Qo
dHJ1ZSk7CiAgICB9CgoKICAgIC8qKgogICAgICAgSXMgdGhlcmUgYSBwcmVwYXJlZCB0cmFuc2Fj
dGlvbiBpbiB0aGUgdHJhbnNhY3Rpb24gdGFibGUuCiAgICAgICA8UD5NVCAtIHVuc2FmZSwgY2Fs
bGVkIGR1cmluZyBib290LCB3aGljaCBpcyBzaW5nbGUgdGhyZWFkZWQuCiAgICAqLwogICAgcHVi
bGljIGJvb2xlYW4gaGFzUHJlcGFyZWRYYWN0KCkKICAgIHsKICAgICAgICByZXR1cm4gaGFzUHJl
cGFyZWRYYWN0KGZhbHNlKTsKICAgIH0KCiAgICAvKioKICAgICAqIElzIHRoZXJlIGEgcHJlcGFy
ZWQgdHJhbnNhY3Rpb24gaW4gdGhlIHRyYW5zYWN0aW9uIHRhYmxlLgogICAgICogCiAgICAgKiA8
UD5NVCAtIHVuc2FmZSwgY2FsbGVyIGlzIHJlY292ZXJ5L2F0IGJvb3QsIHdoaWNoIGlzIHNpbmds
ZSB0aHJlYWRlZC4KICAgICAqCiAgICAgKiBAcGFyYW0gcmVjb3ZlcmVkICA8Y29kZT4gdHJ1ZSA8
L2NvZGU+IHRvIHNlYXJjaCAgZm9yIHRyYW5zYWN0aW9uIAogICAgICogICAgICAgICAgICAgICAg
ICB0aGF0IGFyZSBpbiBwcmVwYXJlZCBkdXJpbmcgcmVjb3ZlcnkuICAKICAgICAqICAgICAgICAg
ICAgICAgICAgcmVjb3ZlcmVkIHRyYW5hY3Rpb24uIAogICAgICogICAgICAgICAgICAgICAgICA8
Y29kZT4gZmFsc2UgPiB0byBzZWFyY2ggZm9yIGp1c3QgcHJlcGFyZWQgCiAgICAgKiAgICAgICAg
ICAgICAgICAgIHRyYW5zYWN0b25zLiAKICAgICAqIEByZXR1cm4gICAgICAgICA8Y29kZT4gdHJ1
ZSBpZiB0aGVyZSBpcyBhIHByZXBhcmVkIHRyYW5zYWN0aW9uIGFuZAogICAgICogICAgICAgICAg
ICAgICAgICByZWNvdmVyZWQgd2hlbiA8Y29kZT4gcmVjb3ZlcmVkIDwvY29kZT4gYXJndW1lbnQg
aXMgCiAgICAgKiAgICAgICAgICAgICAgICAgIDxjb2RlPiB0cnVlIDwvY29kZT4KICAgICAqLwoK
ICAgIHByaXZhdGUgYm9vbGVhbiBoYXNQcmVwYXJlZFhhY3QoYm9vbGVhbiByZWNvdmVyZWQpCiAg
ICB7CiAgICAgICAgZm9yIChJdGVyYXRvciBpdCA9IHRyYW5zLnZhbHVlcygpLml0ZXJhdG9yKCk7
IGl0Lmhhc05leHQoKTsgKQogICAgICAgIHsKICAgICAgICAgICAgVHJhbnNhY3Rpb25UYWJsZUVu
dHJ5IGVudCA9IChUcmFuc2FjdGlvblRhYmxlRW50cnkpIGl0Lm5leHQoKTsKCiAgICAgICAgICAg
IGlmIChlbnQgIT0gbnVsbCAmJiAKICAgICAgICAgICAgICAgIChlbnQuZ2V0VHJhbnNhY3Rpb25T
dGF0dXMoKSAmIFhhY3QuRU5EX1BSRVBBUkVEKSAhPSAwKQogICAgICAgICAgICB7CiAgICAgICAg
ICAgICAgICBpZiAocmVjb3ZlcmVkKSB7CiAgICAgICAgICAgICAgICAgICAgaWYoZW50LmlzUmVj
b3ZlcnkoKSkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAg
ICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAg
ICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAg
IH0KCgoKCgkvKioKCQlHZXQgdGhlIG1vc3QgcmVjZW50bHkgYWRkZWQgdHJhbnNhY3Rpb24gdGhh
dCBzYXlzIGl0IG5lZWRzIHRvIGJlCgkJcm9sbGVkIGJhY2sgZmlyc3QgKGFuIEludGVybmFsWGFj
dCkgZnJvbSB0aGUgdHJhbnNhY3Rpb24gdGFibGUgYW5kIG1ha2UKCQl0aGUgcGFzc2VkIGluIHRy
YW5zYWN0aW9uIGFzc3VtZSBpdHMgaWRlbnRpdHkuIAoJCTxCPiBTaG91bGQgb25seSBiZSB1c2Vk
IGluIHJlY292ZXJ5IHVuZG8gISEgPC9CPgoJCVJFU09MVkU6IChza3UpSSBkb24ndCB0aGluayBl
dmVuIHRoZXNlIGludGVybmFsIHRyYW5zYWN0aW9ucyBuZWVkIHRvIGJlCgkJcm9sbGVkIGJhY2sg
aW4gdGhlIHJldmVyc2Ugb3JkZXIsIGJlY2F1c2UgdGhleSBhcmUgcGh5c2ljYWwgaW4gbmF0dXJl
LgoJCUJ1dCBpdCB3b24ndCBodXJ0LgoKCQk8UD5NVCAtIHVuc2FmZSwgY2FsbGVyIGlzIHJlY292
ZXJ5LCB3aGljaCBpcyBzaW5nbGUgdGhyZWFkZWQuCgkqLwoJcHVibGljIGJvb2xlYW4gZ2V0TW9z
dFJlY2VudFJvbGxiYWNrRmlyc3RUcmFuc2FjdGlvbihSYXdUcmFuc2FjdGlvbiB0cmFuKQoJewoK
CQlpZiAodHJhbnMuaXNFbXB0eSgpKQoJCXsKCQkJLy8gc2V0IHRyYW5hY3Rpb24gdG8gaWRsZQoJ
CQlyZXR1cm4gZmluZEFuZEFzc3VtZVRyYW5zYWN0aW9uKChUcmFuc2FjdGlvbklkKW51bGwsIHRy
YW4pOwoJCX0KCgkJVHJhbnNhY3Rpb25JZCBpZCA9IG51bGw7CgkJZm9yIChJdGVyYXRvciBpdCA9
IHRyYW5zLnZhbHVlcygpLml0ZXJhdG9yKCk7IGl0Lmhhc05leHQoKTsgKQoJCXsKCQkJVHJhbnNh
Y3Rpb25UYWJsZUVudHJ5IGVudCA9IChUcmFuc2FjdGlvblRhYmxlRW50cnkpIGl0Lm5leHQoKTsK
CgkJCWlmIChlbnQgIT0gbnVsbCAmJiBlbnQuaXNVcGRhdGUoKSAmJiBlbnQuaXNSZWNvdmVyeSgp
ICYmCgkJCQkoZW50LmdldFRyYW5zYWN0aW9uU3RhdHVzKCkgJiBYYWN0LlJFQ09WRVJZX1JPTExC
QUNLX0ZJUlNUKSAhPSAwKQoJCQl7CgkJCQkvLyB0cnkgdG8gbG9jYXRlIHRoZSBtb3N0IHJlY2Vu
dCBvbmUKCQkJCWlmIChpZCA9PSBudWxsIHx8IFhhY3RJZC5jb21wYXJlKGlkLCBlbnQuZ2V0WGlk
KCkpIDwgMCkKCQkJCQlpZCA9IGVudC5nZXRYaWQoKTsKCQkJfQoJCX0KCgkJaWYgKGlkID09IG51
bGwpCQkJLy8gc2V0IHRyYW5zYWN0aW9uIHRvIGlkbGUKCQl7CgkJCXJldHVybiBmaW5kQW5kQXNz
dW1lVHJhbnNhY3Rpb24oaWQsIHRyYW4pOwoJCX0KCQllbHNlCgkJewoJCQkvLyB0aGVyZSBpcyBh
IHJvbGxiYWNrIGZpcnN0IHRyYW5zYWN0aW9uCgkJCWJvb2xlYW4gZm91bmQgPSAKICAgICAgICAg
ICAgICAgIGZpbmRBbmRBc3N1bWVUcmFuc2FjdGlvbihpZCwgdHJhbik7CgoJCQlpZiAoU2FuaXR5
TWFuYWdlci5ERUJVRykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKCFmb3VuZCkK
ICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBTYW5pdHlNYW5hZ2VyLlRIUk9X
QVNTRVJUKAogICAgICAgICAgICAgICAgICAgICAgICAiY2Fubm90IGZpbmQgdHJhbnNhY3Rpb24g
IiArIGlkICsgIiBpbiB0YWJsZSIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgoJ
CQlyZXR1cm4gdHJ1ZTsKCQl9Cgl9CgoJLyoqCgkJR2V0IHRoZSBtb3N0IHJlY2VudGx5IG5vbi1w
cmVwYXJlZCBhZGRlZCB0cmFuc2FjdGlvbiBmcm9tIHRoZSAKICAgICAgICB0cmFuc2FjdGlvbiB0
YWJsZSBhbmQgbWFrZSB0aGUgcGFzc2VkIGluIHRyYW5zYWN0aW9uIGFzc3VtZSBpdHMgCiAgICAg
ICAgaWRlbnRpdHkuICBQcmVwYXJlZCB0cmFuc2FjdGlvbnMgd2lsbCBub3QgYmUgdW5kb25lLgoK
CQlSRVNPTFZFOiAoc2t1KSBJIGRvbid0IHRoaW5rIG5vcm1hbCB1c2VyIHRyYW5zYWN0aW9ucyBu
ZWVkcyB0byBiZQoJCXJvbGxlZCBiYWNrIGluIG9yZGVyLCBidXQgaXQgd29uJ3QgaHVydC4KCgkJ
PEI+IFNob3VsZCBvbmx5IGJlIHVzZWQgaW4gcmVjb3ZlcnkgdW5kbyAhISA8L0I+CgoJCTxQPk1U
IC0gdW5zYWZlLCBjYWxsZXIgaXMgcmVjb3ZlcnksIHdoaWNoIGlzIHNpbmdsZSB0aHJlYWRlZC4K
CSovCglwdWJsaWMgYm9vbGVhbiBnZXRNb3N0UmVjZW50VHJhbnNhY3Rpb25Gb3JSb2xsYmFjayhS
YXdUcmFuc2FjdGlvbiB0cmFuKQoJewogICAgICAgIFRyYW5zYWN0aW9uSWQgaWQgPSBudWxsOwoK
ICAgICAgICBpZiAoIXRyYW5zLmlzRW1wdHkoKSkKCQl7CgkJCWZvciAoSXRlcmF0b3IgaXQgPSB0
cmFucy52YWx1ZXMoKS5pdGVyYXRvcigpOyBpdC5oYXNOZXh0KCkgOyApCgkJCXsKCQkJCVRyYW5z
YWN0aW9uVGFibGVFbnRyeSBlbnQgPSAoVHJhbnNhY3Rpb25UYWJsZUVudHJ5KSBpdC5uZXh0KCk7
CgoJCQkJaWYgKGVudCAhPSBudWxsICAgICAgICAgJiYgCiAgICAgICAgICAgICAgICAgICAgZW50
LmlzVXBkYXRlKCkgICAgICAmJiAKICAgICAgICAgICAgICAgICAgICBlbnQuaXNSZWNvdmVyeSgp
ICAgICYmIAogICAgICAgICAgICAgICAgICAgICFlbnQuaXNQcmVwYXJlZCgpKQoJCQkJewoJCQkJ
CS8vIHRyeSB0byBsb2NhdGUgdGhlIG1vc3QgcmVjZW50IG9uZQoJCQkJCWlmIChpZCA9PSBudWxs
IHx8IFhhY3RJZC5jb21wYXJlKGlkLCBlbnQuZ2V0WGlkKCkpIDwgMCkKCQkJCQkJaWQgPSBlbnQu
Z2V0WGlkKCk7CgkJCQl9CgoJCQkJaWYgKFNhbml0eU1hbmFnZXIuREVCVUcpCgkJCQl7CgkJCQkJ
aWYgKGVudCAhPSBudWxsICAgICAgICAgJiYgCiAgICAgICAgICAgICAgICAgICAgICAgIGVudC5p
c1VwZGF0ZSgpICAgICAgJiYgCiAgICAgICAgICAgICAgICAgICAgICAgIGVudC5pc1JlY292ZXJ5
KCkgICAgJiYKCQkJCQkJKGVudC5nZXRUcmFuc2FjdGlvblN0YXR1cygpICYgCiAgICAgICAgICAg
ICAgICAgICAgICAgICBYYWN0LlJFQ09WRVJZX1JPTExCQUNLX0ZJUlNUKSAhPSAwKQogICAgICAg
ICAgICAgICAgICAgIHsKCQkJCQkJU2FuaXR5TWFuYWdlci5USFJPV0FTU0VSVCgKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICJzdGlsbCByb2xsYmFjayBmaXJzdCB4YWN0cyBpbiB0aGUgdHJh
biB0YWJsZSEiKTsKICAgICAgICAgICAgICAgICAgICB9CgkJCQl9CgkJCX0KCgkJCWlmIChTYW5p
dHlNYW5hZ2VyLkRFQlVHKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAvLyBpZiBhbGwg
dHJhbnNhY3Rpb25zIGFyZSBwcmVwYXJlZCB0aGVuIGl0IGlzIHBvc3NpYmxlIHRoYXQKICAgICAg
ICAgICAgICAgIC8vIG5vIHRyYW5zYWN0aW9uIHdpbGwgYmUgZm91bmQsIGluIHRoYXQgY2FzZSBp
ZCB3aWxsIGJlIG51bGwuCiAgICAgICAgICAgICAgICBpZiAoaWQgIT0gbnVsbCkKICAgICAgICAg
ICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBTYW5pdHlNYW5hZ2VyLkFTU0VSVChmaW5kVHJh
bnNhY3Rpb25FbnRyeShpZCkgIT0gbnVsbCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg
ICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gYWxsIHRy
YW5zYWN0aW9ucyBpbiB0aGUgdGFibGUgbXVzdCBiZSBwcmVwYXJlZC4KICAgICAgICAgICAgICAg
ICAgICBmb3IgKEl0ZXJhdG9yIGl0ID0gdHJhbnMudmFsdWVzKCkuaXRlcmF0b3IoKTsgaXQuaGFz
TmV4dCgpOykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIFRy
YW5zYWN0aW9uVGFibGVFbnRyeSBlbnQgPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKFRy
YW5zYWN0aW9uVGFibGVFbnRyeSkgaXQubmV4dCgpOwogICAgICAgICAgICAgICAgICAgICAgICBT
YW5pdHlNYW5hZ2VyLkFTU0VSVChlbnQuaXNQcmVwYXJlZCgpKTsKICAgICAgICAgICAgICAgICAg
ICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCQl9CgogICAgICAgIHJldHVybihm
aW5kQW5kQXNzdW1lVHJhbnNhY3Rpb24oaWQsIHRyYW4pKTsKCX0JCgoJLyoqCgkJR2V0IHRoZSBt
b3N0IHJlY2VudGx5IGFkZGVkIHRyYW5zYWN0aW9uIHRoYXQgc2F5cyBpdCBpcyBwcmVwYXJlZCBk
dXJpbmcKICAgICAgICByZWNvdmVyeSB0aGUgdHJhbnNhY3Rpb24gdGFibGUgYW5kIG1ha2UgdGhl
IHBhc3NlZCBpbiB0cmFuc2FjdGlvbiAKICAgICAgICBhc3N1bWUgaXRzIGlkZW50aXR5LiBUaGlz
IHJvdXRpbmUgdHVybnMgb2ZmIHRoZSBpc1JlY292ZXJ5KCkgc3RhdGUKCQk8Qj4gU2hvdWxkIG9u
bHkgYmUgdXNlZCBpbiByZWNvdmVyeSBoYW5kbGUgcHJlcGFyZSBhZnRlciB1bmRvICEhIDwvQj4K
CgkJPFA+TVQgLSB1bnNhZmUsIGNhbGxlciBpcyByZWNvdmVyeSwgd2hpY2ggaXMgc2luZ2xlIHRo
cmVhZGVkLgoJKi8KCiAgICAvKioKICAgICAqIEdldCB0aGUgbW9zdCByZWNlbnQgcmVjb3ZlcmVk
IHByZXBhcmVkIHRyYW5zYWN0aW9uLgogICAgICogPHA+CiAgICAgKiBHZXQgdGhlIG1vc3QgcmVj
ZW50bHkgYWRkZWQgdHJhbnNhY3Rpb24gdGhhdCBzYXlzIGl0IGlzIHByZXBhcmVkIGR1cmluZyAK
ICAgICAqIHJlY292ZXJ5IHRoZSB0cmFuc2FjdGlvbiB0YWJsZSBhbmQgbWFrZSB0aGUgcGFzc2Vk
IGluIHRyYW5zYWN0aW9uIAogICAgICogYXNzdW1lIGl0cyBpZGVudGl0eS4gCiAgICAgKiA8cD4K
ICAgICAqIFRoaXMgcm91dGluZSwgdW5saWtlIHRoZSByZWRvIGFuZCByb2xsYmFjayBnZXRNb3N0
UmVjZW50KigpIHJvdXRpbmVzCiAgICAgKiBleHBlY3RzIGEgYnJhbmQgbmV3IHRyYW5zYWN0aW9u
IHRvIGJlIHBhc3NlZCBpbi4gIElmIGEgY2FuZGlkYXRlIAogICAgICogdHJhbnNhY3Rpb24gaXMg
Zm91bmQsIHRoZW4gdXBvbiByZXR1cm4gdGhlIHRyYW5zYWN0aW9uIHRhYmxlIHdpbGwgCiAgICAg
KiBiZSBhbHRlcmVkIHN1Y2ggdGhhdCB0aGUgb2xkIGVudHJ5IG5vIGxvbmdlciBleGlzdHMsIGFu
ZCBhIG5ldyBlbnRyeQogICAgICogd2lsbCBleGlzdCBwb2ludGluZyB0byB0aGUgdHJhbnNhY3Rp
b24gcGFzc2VkIGluLiAgVGhlIG5ldyBlbnRyeSB3aWxsCiAgICAgKiBsb29rIHRoZSBzYW1lIGFz
IGlmIHRoZSBwcmVwYXJlZCB0cmFuc2FjdGlvbiBoYWQgYmVlbiBjcmVhdGVkIGR1cmluZwogICAg
ICogcnVudGltZSByYXRoZXIgdGhhbiByZWNvdmVyeS4KICAgICAqCiAgICAgKiA8Qj4gU2hvdWxk
IG9ubHkgYmUgdXNlZCBpbiByZWNvdmVyeSBoYW5kbGUgcHJlcGFyZSBhZnRlciB1bmRvICEhIDwv
Qj4KICAgICAqCiAgICAgKiA8UD5NVCAtIHVuc2FmZSwgY2FsbGVyIGlzIHJlY292ZXJ5LCB3aGlj
aCBpcyBzaW5nbGUgdGhyZWFkZWQuCiAgICAgKgoJICogQHJldHVybiB0cnVlIGlmIGEgY2FuZGlk
YXRlIHRyYW5zYWN0aW9uIGhhcyBiZWVuIGZvdW5kLiAgZmFsc2UgaWYgbm8KICAgICAqICAgICAg
ICAgcHJlcGFyZWQvcmVjb3ZlcnkgdHJhbnNhY3Rpb25zIGZvdW5kIGluIHRoZSB0YWJsZS4KICAg
ICAqCiAgICAgKiBAcGFyYW0gdHJhbiAgIE5ld2x5IGFsbG9jYXRlZCB0cmFuc2FjdGlvbiB0byBh
ZGQgdG8gbGluayB0byBhIGVudHJ5LgogICAgICoKICAgICAqKi8KCXB1YmxpYyBib29sZWFuIGdl
dE1vc3RSZWNlbnRQcmVwYXJlZFJlY292ZXJlZFhhY3QoCiAgICBSYXdUcmFuc2FjdGlvbiB0cmFu
KQoJewogICAgICAgIFRyYW5zYWN0aW9uVGFibGVFbnRyeSAgIGZvdW5kX2VudCAgID0gbnVsbDsK
CiAgICAgICAgaWYgKCF0cmFucy5pc0VtcHR5KCkpCgkJewogICAgICAgICAgICBUcmFuc2FjdGlv
bklkICAgICAgICAgICBpZCAgICAgICAgICA9IG51bGw7CiAgICAgICAgICAgIEdsb2JhbFRyYW5z
YWN0aW9uSWQgICAgIGdpZCAgICAgICAgID0gbnVsbDsKICAgICAgICAgICAgVHJhbnNhY3Rpb25U
YWJsZUVudHJ5ICAgZW50OwoKCQkJZm9yIChJdGVyYXRvciBpdCA9IHRyYW5zLnZhbHVlcygpLml0
ZXJhdG9yKCk7IGl0Lmhhc05leHQoKTsgKQoJCQl7CgkJCQllbnQgPSAoVHJhbnNhY3Rpb25UYWJs
ZUVudHJ5KSBpdC5uZXh0KCk7CgoJCQkJaWYgKGVudCAhPSBudWxsICAgICAgICAgJiYgCiAgICAg
ICAgICAgICAgICAgICAgZW50LmlzUmVjb3ZlcnkoKSAgICAmJiAKICAgICAgICAgICAgICAgICAg
ICBlbnQuaXNQcmVwYXJlZCgpKQoJCQkJewoJCQkJCS8vIHRyeSB0byBsb2NhdGUgdGhlIG1vc3Qg
cmVjZW50IG9uZQoJCQkJCWlmIChpZCA9PSBudWxsIHx8IFhhY3RJZC5jb21wYXJlKGlkLCBlbnQu
Z2V0WGlkKCkpIDwgMCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAg
ICAgIGZvdW5kX2VudCA9IGVudDsKCQkJCQkJaWQgICAgICAgID0gZW50LmdldFhpZCgpOwoJCQkJ
CQlnaWQgICAgICAgPSBlbnQuZ2V0R2lkKCk7CiAgICAgICAgICAgICAgICAgICAgfQoJCQkJfQoJ
CQl9CgogICAgICAgICAgICBpZiAoU2FuaXR5TWFuYWdlci5ERUJVRykKICAgICAgICAgICAgewog
ICAgICAgICAgICAgICAgaWYgKGZvdW5kX2VudCA9PSBudWxsKQogICAgICAgICAgICAgICAgewog
ICAgICAgICAgICAgICAgICAgIC8vIGlmIG5vIGVudHJ5J3Mgd2VyZSBmb3VuZCB0aGVuIHRoZSB0
cmFuc2FjdGlvbiB0YWJsZQogICAgICAgICAgICAgICAgICAgIC8vIHNob3VsZCBoYXZlIHRoZSBw
YXNzZWQgaW4gaWRsZSB0cmFuLCBhbmQgdGhlIHJlc3Qgc2hvdWxkCiAgICAgICAgICAgICAgICAg
ICAgLy8gYmUgbm9uLXJlY292ZXIsIHByZXBhcmVkIGdsb2JhbCB0cmFuc2FjdGlvbnMuCiAgICAg
ICAgICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdCA9IHRyYW5zLnZhbHVlcygpLml0ZXJhdG9y
KCk7IGl0Lmhhc05leHQoKTspCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAg
ICAgICAgICBlbnQgPSAoVHJhbnNhY3Rpb25UYWJsZUVudHJ5KSBpdC5uZXh0KCk7CgogICAgICAg
ICAgICAgICAgICAgICAgICBpZiAoWGFjdElkLmNvbXBhcmUoZW50LmdldFhpZCgpLCB0cmFuLmdl
dElkKCkpICE9IDApCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIFNhbml0eU1hbmFnZXIuQVNTRVJUKAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICFlbnQuaXNSZWNvdmVyeSgpICYmIGVudC5pc1ByZXBhcmVkKCkpOwogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgU2FuaXR5TWFuYWdlci5BU1NFUlQoZW50LmdldEdpZCgpICE9IG51
bGwpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAg
ICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZm91bmRfZW50ICE9
IG51bGwpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIC8vIEF0IHRoaXMgcG9pbnQgdGhl
cmUgYXJlIDIgdHQgZW50cmllcyBvZiBpbnRlcmVzdDoKICAgICAgICAgICAgICAgIC8vICAgICBu
ZXdfZW50IC0gdGhlIHJlYWQgb25seSB0cmFuc2FjdGlvbiBlbnRyeSB0aGF0IHdhcyAKICAgICAg
ICAgICAgICAgIC8vICAgICAgICAgICAgICAgY3JlYXRlZCB3aGVuIHdlIGFsbG9jYXRlZCBhIG5l
dyB0cmFuc2FjdGlvbi4KICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgV2Ugd2lsbCBq
dXN0IHRocm93IHRoaXMgb25lIGF3YXkgYWZ0ZXIgCiAgICAgICAgICAgICAgICAvLyAgICAgICAg
ICAgICAgIGFzc3VtaW5nIHRoZSBpZGVudGl0eSBvZiB0aGUgZ2xvYmFsIHhhY3QuCiAgICAgICAg
ICAgICAgICAvLyAgICAgZm91bmRfZW50CiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAt
IHRoZSBlbnRyeSBvZiB0aGUgdHJhbnNhY3Rpb24gdGhhdCB3ZSBhcmUgZ29pbmcKICAgICAgICAg
ICAgICAgIC8vICAgICAgICAgICAgICAgdG8gdGFrZSBvdmVyLgogICAgICAgICAgICAgICAgVHJh
bnNhY3Rpb25UYWJsZUVudHJ5IG5ld19lbnQgPQogICAgICAgICAgICAgICAgICAgIChUcmFuc2Fj
dGlvblRhYmxlRW50cnkpIHRyYW5zLnJlbW92ZSh0cmFuLmdldElkKCkpOwoKICAgICAgICAgICAg
ICAgIC8vIEF0IHRoaXMgcG9pbnQgb25seSB0aGUgZm91bmRfZW50IHNob3VsZCBiZSBpbiB0aGUg
dGFibGUuCiAgICAgICAgICAgICAgICBpZiAoU2FuaXR5TWFuYWdlci5ERUJVRykKICAgICAgICAg
ICAgICAgIHsKCSAgICAgICAgICAgICAgICBTYW5pdHlNYW5hZ2VyLkFTU0VSVChmaW5kVHJhbnNh
Y3Rpb25FbnRyeShpZCkgPT0gZm91bmRfZW50KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAg
ICAgICAgICAoKFhhY3QpIHRyYW4pLmFzc3VtZUdsb2JhbFhhY3RJZGVudGl0eShmb3VuZF9lbnQp
OwoKICAgICAgICAgICAgICAgIC8vIHRyYW5zZm9ybSB0aGlzIHJlY292ZXJ5IGVudHJ5LCBpbnRv
IGEgcnVudGltZSBlbnRyeS4KICAgICAgICAgICAgICAgIGZvdW5kX2VudC51bnNldFJlY292ZXJ5
U3RhdHVzKCk7CiAgICAgICAgICAgIH0KCQl9CgogICAgICAgIHJldHVybihmb3VuZF9lbnQgIT0g
bnVsbCk7Cgl9CgoJLyoqCgkJR2V0IHRoZSBsZWFzdCByZWNlbnRseSBhZGRlZCAob2xkZXN0KSB0
cmFuc2FjdGlvbgoJCUByZXR1cm4gdGhlIFJhd1RyYW5zYWN0aW9uJ3MgZmlyc3QgbG9nIGluc3Rh
bnQKCgkJPFA+TVQgLSBzYWZlLCBjYWxsZXIgY2FuIGJlIHJlY292ZXJ5IG9yIGNoZWNrcG9pbnQK
CSovCglwdWJsaWMgTG9nSW5zdGFudCBnZXRGaXJzdExvZ0luc3RhbnQoKQoJewoJCS8vIGFzc3Vt
ZSBmb3Igbm93IHRoYXQgaXQgaXMgYWNjZXB0YWJsZSB0byByZXR1cm4gbnVsbCBpZiBhIHRyYW5z
YWN0aW9uCgkJLy8gc3RhcnRzIHJpZ2h0IGluIHRoZSBtaWRkbGUgb2YgdGhpcyBjYWxsLgoKCQlp
ZiAodHJhbnMuaXNFbXB0eSgpKQogICAgICAgIHsKCQkJcmV0dXJuIG51bGw7CiAgICAgICAgfQoJ
CWVsc2UKCQl7CgkJCUxvZ0luc3RhbnQgbG9nSW5zdGFudCA9IG51bGw7CiAgICAgICAgICAgIAog
ICAgICAgICAgICAvLyBidWcgNTYzMjogbmVlZCB0byBzeWNocm9uaXplIHNvIHRoYXQgYW5vdGhl
ciB0aHJlYWQgZG9lcyBub3QgCiAgICAgICAgICAgIC8vIGNvbWUgaW4gYW5kIGRpc3J1cHQgdGhl
IGZvciBsb29wLCB3ZSBnb3QgYW4gZXhjZXB0aW9uIG9uIG5leHQsCiAgICAgICAgICAgIC8vIGxp
a2VseSBiZWNhdXNlIGhhc2ggdGFibGUgY2hhbmdlZCBieSBhbm90aGVyIHRocmVhZCBhZnRlcgog
ICAgICAgICAgICAvLyBoYXNNb3JlRWxlbWVudHMoKSBjYWxsZWQsIGJ1dCBiZWZvcmUgbmV4dEVs
ZW1lbnQoKS4KCiAgICAgICAgICAgIHN5bmNocm9uaXplZCAodHJhbnMpCiAgICAgICAgICAgIHsK
ICAgICAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXQgPSB0cmFucy52YWx1ZXMoKS5pdGVyYXRv
cigpOyBpdC5oYXNOZXh0KCk7ICkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAg
ICBUcmFuc2FjdGlvblRhYmxlRW50cnkgZW50ID0KICAgICAgICAgICAgICAgICAgICAgICAgKFRy
YW5zYWN0aW9uVGFibGVFbnRyeSkgaXQubmV4dCgpOwoKICAgICAgICAgICAgICAgICAgICBpZiAo
ZW50ICE9IG51bGwgJiYgZW50LmlzVXBkYXRlKCkpCiAgICAgICAgICAgICAgICAgICAgewogICAg
ICAgICAgICAgICAgICAgICAgICBpZiAobG9nSW5zdGFudCA9PSBudWxsIHx8IAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgZW50LmdldEZpcnN0TG9nKCkubGVzc1RoYW4obG9nSW5zdGFudCkp
CiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxv
Z0luc3RhbnQgPSBlbnQuZ2V0Rmlyc3RMb2coKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQog
ICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKCQkJ
cmV0dXJuIGxvZ0luc3RhbnQ7CgkJfQoJfQoKCS8qKgoJCUZpbmQgYSB0cmFuc2FjdGlvbiB1c2lu
ZyB0aGUgdHJhbnNhY3Rpb24gaWQsIGFuZCBtYWtlIHRoZSBwYXNzZWQgaW4KCQl0cmFuc2FjdGlv
biBhc3N1bWUgdGhlIGlkZW50aXR5IGFuZCBwcm9wZXJ0aWVzIG9mIHRoYXQgdHJhbnNhY3Rpb24u
CgoJCTxQPk1UIC0gdW5zYWZlLCBjYWxsZXIgaXMgcmVjb3ZlcnksIHdoaWNoIGlzIHNpbmdsZSB0
aHJlYWRlZC4KCgkJQHBhcmFtIGlkIHRyYW5zYWN0aW9uIElkCgkJQHBhcmFtIHRyYW4gdGhlIHRy
YW5zYWN0aW9uIHRoYXQgd2FzIG1hZGUgdG8gYXNzdW1lIHRoZSB0cmFuc2FjdGlvbklECgkJYW5k
IGFsbCBvdGhlciByZWxhdmVudCBpbmZvcm1hdGlvbiBzdG9yZWQgaW4gdGhlIHRyYW5zYWN0aW9u
IHRhYmxlCgkJQHJldHVybiB0cnVlIGlmIHRyYW5zYWN0aW9uIGNhbiBiZSBmb3VuZCwgZmFsc2Ug
b3RoZXJ3aXNlCgkqLwoJYm9vbGVhbiBmaW5kQW5kQXNzdW1lVHJhbnNhY3Rpb24oCiAgICBUcmFu
c2FjdGlvbklkICAgICAgIGlkLCAKICAgIFJhd1RyYW5zYWN0aW9uICAgICAgdHJhbikKCXsKCQkv
LyB0aGUgb25seSBjYWxsZXIgZm9yIHRoaXMgbWV0aG9kIHJpZ2h0IG5vdyBpcyByZWNvdmVyeS4g
IAogICAgICAgIC8vIE5vIG5lZWQgdG8gcHV0IGluIGFueSBjb25jdXJyZW5jeSBjb250cm9sCgkJ
VHJhbnNhY3Rpb25UYWJsZUVudHJ5IGVudCA9IG51bGw7CgoJCWlmIChpZCAhPSBudWxsICYmICF0
cmFucy5pc0VtcHR5KCkpCgkJewoJCQllbnQgPSBmaW5kVHJhbnNhY3Rpb25FbnRyeShpZCk7CgoJ
CQlpZiAoU2FuaXR5TWFuYWdlci5ERUJVRykKCQkJewoJCQkJaWYgKGVudCAhPSBudWxsKQoJCQkJ
CVNhbml0eU1hbmFnZXIuQVNTRVJUKGVudC5pc1JlY292ZXJ5KCksCgkJCQkJImFzc3VtaW5nIHRo
ZSBpZCBvZiBhIG5vbi1yZWNvdmVyeSB0cmFuc2FjdGlvbiIpOwoJCQl9CgkJfQoKCQkvLyBpZiBu
byB0cmFuc2FjdGlvbiBlbnRyeSBmb3VuZCwgc2V0IHRyYW5zYWN0aW9uIHRvIGlkbGUKICAgICAg
ICAoKFhhY3QpdHJhbikuYXNzdW1lSWRlbnRpdHkoZW50KTsKCgkJcmV0dXJuKGVudCAhPSBudWxs
KTsKCgl9CgoJLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioKCSAqIFRyYW5zYWN0aW9uIHRhYmxlIHZ0aSBhbmQgZGlhZ25vc3RpY3MKCSAq
IE1UIC0gdW5zYWZlLCBjYWxsZXIgaXMgZ2V0dGluZyBhIHNuYXAgc2hvdCB3aGljaCBtYXkgYmUg
aW5jb25zaXN0ZW50IAoJICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKi8KCgkvKioKCQlHZXQgYSBwcmludGFibGUgdmVyc2lvbiBvZiB0aGUg
dHJhbnNhY3Rpb24gdGFibGUKCSAqLwoJcHVibGljIFRyYW5zYWN0aW9uSW5mb1tdIGdldFRyYW5z
YWN0aW9uSW5mbygpCgl7CgkJaWYgKHRyYW5zLmlzRW1wdHkoKSkKCQkJcmV0dXJuIG51bGw7CgoJ
CS8vIHdoaWxlIHRha2luZyBhIHNuYXAgc2hvdCwgbm8gYWRkaW5nIG9yIHJlbW92aW5nIG9mIHRy
YW5zYWN0aW9uCgkJVHJhbnNhY3Rpb25JbmZvW10gdGluZm87CgogICAgICAgIC8vIFN5bmNocm9u
aXplIG9uIHRyYW5zIHRvIHByZXZlbnQgcHJvYmxlbXMgdGhhdCBjb3VsZCBvY2N1ciBpZgogICAg
ICAgIC8vIGVsZW1lbnRzIGFyZSBhZGRlZCB0byBvciByZW1vdmVkIGZyb20gdGhlIEhhc2h0YWJs
ZSB3aGlsZSB3ZSdyZQogICAgICAgIC8vIGxvb3BpbmcgdGhyb3VnaCB0aGUgZWxlbWVudHMuIFBv
c3NpYmxlIHByb2JsZW1zIGluY2x1ZGU6CiAgICAgICAgLy8gICAtIEFycmF5SW5kZXhPdXRPZkJv
dW5kc0V4Y2VwdGlvbiBpZiBhIHRyYW5zYWN0aW9uIGlzIGFkZGVkIGFmdGVyCiAgICAgICAgLy8g
ICAgIHRoZSBjYWxsIHRvIHRyYW5zLnNpemUoKQogICAgICAgIC8vICAgLSBBc3NlcnQgZmFpbHVy
ZSwgdHggdGFibGUgaGFzIG51bGwgZW50cnkgKERFUkJZLTM3NTcpCiAgICAgICAgLy8gICAtIE5v
U3VjaEVsZW1lbnRFeGNlcHRpb24gKERFUkJZLTM5MTYpCiAgICAgICAgc3luY2hyb25pemVkICh0
cmFucykKCQl7CgkJCWlmIChTYW5pdHlNYW5hZ2VyLkRFQlVHKQoJCQkJU2FuaXR5TWFuYWdlci5E
RUJVRygiVHJhblRyYWNlIiwgdG9TdHJpbmcoKSk7CgoJCQlpbnQgbnRyYW4gPSB0cmFucy5zaXpl
KCk7CgkJCXRpbmZvID0gbmV3IFRyYW5zYWN0aW9uVGFibGVFbnRyeVtudHJhbl07CgoJCQlpbnQg
aSA9IDA7CgoJCQlmb3IgKEl0ZXJhdG9yIGl0ID0gdHJhbnMudmFsdWVzKCkuaXRlcmF0b3IoKTsg
aXQuaGFzTmV4dCgpOyApCgkJCXsKCQkJCVRyYW5zYWN0aW9uVGFibGVFbnRyeSBlbnQgPSAoVHJh
bnNhY3Rpb25UYWJsZUVudHJ5KSBpdC5uZXh0KCk7CgoJCQkJaWYgKGVudCAhPSBudWxsKQoJCQkJ
CXRpbmZvW2krK10gPSAoVHJhbnNhY3Rpb25UYWJsZUVudHJ5KWVudC5jbG9uZSgpOwoKCQkJCWlm
IChTYW5pdHlNYW5hZ2VyLkRFQlVHKQoJCQkJCVNhbml0eU1hbmFnZXIuQVNTRVJUKGVudCAhPSBu
dWxsLCAidHJhbnNhY3Rpb24gdGFibGUgaGFzIG51bGwgZW50cnkiKTsKCQkJfQoJCX0KCgkJcmV0
dXJuIHRpbmZvOwoJfQoKCXB1YmxpYyBTdHJpbmcgdG9TdHJpbmcoKQoJewoJCWlmIChTYW5pdHlN
YW5hZ2VyLkRFQlVHKQoJCXsKCQkJU3RyaW5nQnVmZmVyIHN0ciA9IG5ldyBTdHJpbmdCdWZmZXIo
MTAwMCkuCgkJCQlhcHBlbmQoIlxuKioqKioqKioqKioqKioqKioqKioqKioqKipcbiIpLgoJCQkJ
YXBwZW5kKHN1cGVyLnRvU3RyaW5nKCkpLgoJCQkJYXBwZW5kKCJcblRyYW5zYWN0aW9uIFRhYmxl
OiBzaXplID0gIikuYXBwZW5kKHRyYW5zLnNpemUoKSkuCgkJCQlhcHBlbmQoIiBsYXJnZXN0VXBk
YXRlWGFjdElkID0gIikuYXBwZW5kKGxhcmdlc3RVcGRhdGVYYWN0SWQpLgoJCQkJYXBwZW5kKCJc
biIpOwoKCQkJYm9vbGVhbiBoYXNSZWFkT25seVRyYW5zYWN0aW9uID0gZmFsc2U7CgoJCQlmb3Ig
KEl0ZXJhdG9yIGl0ID0gdHJhbnMudmFsdWVzKCkuaXRlcmF0b3IoKTsgaXQuaGFzTmV4dCgpOyAp
CgkJCXsKCQkJCVRyYW5zYWN0aW9uVGFibGVFbnRyeSBlbnQgPSAoVHJhbnNhY3Rpb25UYWJsZUVu
dHJ5KSBpdC5uZXh0KCk7CgoJCQkJaWYgKGVudCAhPSBudWxsICYmIGVudC5pc1VwZGF0ZSgpKQoJ
CQkJCXN0ci5hcHBlbmQoZW50LnRvU3RyaW5nKCkpOwoKCQkJCWlmIChlbnQgIT0gbnVsbCAmJiAh
ZW50LmlzVXBkYXRlKCkpCgkJCQkJaGFzUmVhZE9ubHlUcmFuc2FjdGlvbiA9IHRydWU7CgkJCX0K
CgkJCWlmIChoYXNSZWFkT25seVRyYW5zYWN0aW9uKQoJCQl7CgkJCQlzdHIuYXBwZW5kKCJcbiBS
RUFEIE9OTFkgVFJBTlNBQ1RJT05TIFxuIik7CgoJCQkJZm9yIChJdGVyYXRvciBpdCA9IHRyYW5z
LnZhbHVlcygpLml0ZXJhdG9yKCk7IGl0Lmhhc05leHQoKTsgKQoJCQkJewoJCQkJCVRyYW5zYWN0
aW9uVGFibGVFbnRyeSBlbnQgPQoJCQkJCQkoVHJhbnNhY3Rpb25UYWJsZUVudHJ5KSBpdC5uZXh0
KCk7CgoJCQkJCWlmIChlbnQgIT0gbnVsbCAmJiAhZW50LmlzVXBkYXRlKCkpCgkJCQkJCXN0ci5h
cHBlbmQoZW50LnRvU3RyaW5nKCkpOwoJCQkJfQoJCQl9CgkJCXN0ci5hcHBlbmQoIi0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLSIpOwoJCQlyZXR1cm4gc3RyLnRvU3RyaW5nKCk7CgkJfQoJCWVs
c2UKCQkJcmV0dXJuIG51bGw7Cgl9CgoKfQoK
</data>

          </attachment>
      

    </bug>

</bugzilla>