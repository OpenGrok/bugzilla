<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "http://defect.opensolaris.org/bz/bugzilla.dtd">

<bugzilla version="3.6.5"
          urlbase="http://defect.opensolaris.org/bz/"
          
          maintainer="website-admin@opensolaris.org"
>

    <bug>
          <bug_id>3900</bug_id>
          
          <creation_ts>2008-10-14 04:03:00 +0000</creation_ts>
          <short_desc>Unexpected result when clicking a symbol definition</short_desc>
          <delta_ts>2010-02-20 23:29:00 +0000</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Development</classification>
          <product>opengrok</product>
          <component>webapp</component>
          <version>unspecified</version>
          <rep_platform>ANY/Generic</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>FIXED</resolution>
          
          
          
          
          
          <priority>P4</priority>
          <bug_severity>minor</bug_severity>
          <target_milestone>0.9</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jason Leonard">jason</reporter>
          <assigned_to name="Knut Anders Hatlen">knut.hatlen</assigned_to>
          <cc>knut.hatlen</cc>
    
    <cc>opengrok-dev</cc>
          

      

      

      

          <long_desc isprivate="0">
            <commentid>14616</commentid>
            <who name="Jason Leonard">jason</who>
            <bug_when>2008-10-14 04:03:22 +0000</bug_when>
            <thetext>When viewing code, clicking on a symbol definition that is defined or referenced only in this file returns you a redirect back to the symbol definition. 

To reproduce...
Make a new project called &quot;test-tree&quot; and include only this file...

&lt;test.c&gt;
int MyFunc()
{
	return 0;
}

void testMyFunc()
{
	int i = MyFunc();
	int j = MyFunc();	
}

Once this has been indexed, clicking on the topmost MyFunc directs you too
http://&lt;hostname&gt;/source/s?refs=MyFunc&amp;project=/test-tree
But the search code subsequently redirects you to 
http://&lt;hostname&gt;/source/xref/test-tree/test.c#MyFunc
And hence back the symbol definition. No mention of the MyFunc references are shown.

A work around is to perform the search from the search page.

Interestingly...
search.jsp contains a comment right before a test for these conditions...
    // @TODO fix me. I should try to figure out where the exact hit is instead
    // of returning a page with just _one_ entry in....

Expected...
A result page containing all references to MyFunc.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>66497</commentid>
            <who name="Knut Anders Hatlen">knut.hatlen</who>
            <bug_when>2010-02-17 11:17:55 +0000</bug_when>
            <thetext>I think the link on the symbol definition should have said &quot;/source/search?&quot; instead of &quot;/source/s?&quot; Then it will show the matches instead of jumping back to the definition.

This is only a problem if the symbol only exists in a single file. If the symbol is used in more than one file, a list of matches is returned also with the current code.

The links are generated by the analyzers, so I&apos;m changing component from webapp to analyzer. I&apos;ve seen this problem with Java files myself. The bug description shows an example with a C file. Looks like this could be a problem with many/most of the analyzers, then.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>66989</commentid>
            <who name="Knut Anders Hatlen">knut.hatlen</who>
            <bug_when>2010-02-20 23:22:56 +0000</bug_when>
            <thetext>I think there&apos;s a problem with the above mentioned code in search.jsp that should be fixed, and that fix will make it unnecessary to change &quot;/s?&quot; to &quot;/search?&quot;. Recategorizing back to webapp.

The problem is that it always tries to generate a direct link to the symbol definition if the search is for a single term and only one file has a match. This makes sense when searching for a symbol definition, but not when searching for symbol references, as we do in this case. We should add an extra condition to prevent jumping directly to the definition when searching for all references.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>66990</commentid>
            <who name="Knut Anders Hatlen">knut.hatlen</who>
            <bug_when>2010-02-20 23:29:00 +0000</bug_when>
            <thetext>Fixed in changeset 942:3d80d7cf451d.</thetext>
          </long_desc>
      
      

    </bug>

</bugzilla>